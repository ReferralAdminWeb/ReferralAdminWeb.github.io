"use strict";(self.webpackChunkant_design_pro=self.webpackChunkant_design_pro||[]).push([[463],{37476:function(ne,B,r){r.d(B,{Y:function(){return z}});var h=r(74165),C=r(15861),P=r(1413),I=r(97685),H=r(91),w=r(73177),y=r(28459),$=r(28248),Z=r(55917),W=r(21770),E=r(80334),l=r(67294),F=r(73935),X=r(78733),o=r(85893),k=["children","trigger","onVisibleChange","onOpenChange","modalProps","onFinish","submitTimeout","title","width","visible","open"];function z(m){var s,f,V=m.children,g=m.trigger,L=m.onVisibleChange,U=m.onOpenChange,n=m.modalProps,R=m.onFinish,O=m.submitTimeout,G=m.title,J=m.width,T=m.visible,S=m.open,d=(0,H.Z)(m,k);(0,E.ET)(!d.footer||!(n!=null&&n.footer),"ModalForm \u662F\u4E00\u4E2A ProForm \u7684\u7279\u6B8A\u5E03\u5C40\uFF0C\u5982\u679C\u60F3\u81EA\u5B9A\u4E49\u6309\u94AE\uFF0C\u8BF7\u4F7F\u7528 submit.render \u81EA\u5B9A\u4E49\u3002");var j=(0,l.useContext)(y.ZP.ConfigContext),Q=(0,l.useState)([]),A=(0,I.Z)(Q,2),b=A[1],M=(0,l.useState)(!1),c=(0,I.Z)(M,2),K=c[0],e=c[1],se=(0,W.Z)(!!T,{value:S||T,onChange:U||L}),ee=(0,I.Z)(se,2),N=ee[0],D=ee[1],Y=(0,l.useRef)(null),te=(0,l.useCallback)(function(i){Y.current===null&&i&&b([]),Y.current=i},[]),x=(0,l.useRef)(),ae=(0,l.useCallback)(function(){var i,t,a,_=(i=(t=d.form)!==null&&t!==void 0?t:(a=d.formRef)===null||a===void 0?void 0:a.current)!==null&&i!==void 0?i:x.current;_&&n!==null&&n!==void 0&&n.destroyOnClose&&_.resetFields()},[n==null?void 0:n.destroyOnClose,d.form,d.formRef]);(0,l.useImperativeHandle)(d.formRef,function(){return x.current},[x.current]),(0,l.useEffect)(function(){(S||T)&&(U==null||U(!0),L==null||L(!0))},[T,S]);var oe=(0,l.useMemo)(function(){return g?l.cloneElement(g,(0,P.Z)((0,P.Z)({key:"trigger"},g.props),{},{onClick:function(){var i=(0,C.Z)((0,h.Z)().mark(function a(_){var v,u;return(0,h.Z)().wrap(function(p){for(;;)switch(p.prev=p.next){case 0:D(!N),(v=g.props)===null||v===void 0||(u=v.onClick)===null||u===void 0||u.call(v,_);case 2:case"end":return p.stop()}},a)}));function t(a){return i.apply(this,arguments)}return t}()})):null},[D,g,N]),le=(0,l.useMemo)(function(){var i,t,a,_,v,u;return d.submitter===!1?!1:(0,Z.Z)({searchConfig:{submitText:(i=(t=n==null?void 0:n.okText)!==null&&t!==void 0?t:(a=j.locale)===null||a===void 0||(a=a.Modal)===null||a===void 0?void 0:a.okText)!==null&&i!==void 0?i:"\u786E\u8BA4",resetText:(_=(v=n==null?void 0:n.cancelText)!==null&&v!==void 0?v:(u=j.locale)===null||u===void 0||(u=u.Modal)===null||u===void 0?void 0:u.cancelText)!==null&&_!==void 0?_:"\u53D6\u6D88"},resetButtonProps:{preventDefault:!0,disabled:O?K:void 0,onClick:function(p){var q;D(!1),n==null||(q=n.onCancel)===null||q===void 0||q.call(n,p)}}},d.submitter)},[(s=j.locale)===null||s===void 0||(s=s.Modal)===null||s===void 0?void 0:s.cancelText,(f=j.locale)===null||f===void 0||(f=f.Modal)===null||f===void 0?void 0:f.okText,n,d.submitter,D,K,O]),ie=(0,l.useCallback)(function(i,t){return(0,o.jsxs)(o.Fragment,{children:[i,Y.current&&t?(0,o.jsx)(l.Fragment,{children:(0,F.createPortal)(t,Y.current)},"submitter"):t]})},[]),ue=(0,l.useCallback)(function(){var i=(0,C.Z)((0,h.Z)().mark(function t(a){var _,v,u;return(0,h.Z)().wrap(function(p){for(;;)switch(p.prev=p.next){case 0:return _=R==null?void 0:R(a),O&&_ instanceof Promise&&(e(!0),v=setTimeout(function(){return e(!1)},O),_.finally(function(){clearTimeout(v),e(!1)})),p.next=4,_;case 4:return u=p.sent,u&&D(!1),p.abrupt("return",u);case 7:case"end":return p.stop()}},t)}));return function(t){return i.apply(this,arguments)}}(),[R,D,O]),de=(0,w.X)(N);return(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)($.Z,(0,P.Z)((0,P.Z)((0,P.Z)({title:G,width:J||800},n),de),{},{onCancel:function(t){var a;O&&K||(D(!1),n==null||(a=n.onCancel)===null||a===void 0||a.call(n,t))},afterClose:function(){var t;ae(),N&&D(!1),n==null||(t=n.afterClose)===null||t===void 0||t.call(n)},footer:d.submitter!==!1?(0,o.jsx)("div",{ref:te,style:{display:"flex",justifyContent:"flex-end"}}):null,children:(0,o.jsx)(X.I,(0,P.Z)((0,P.Z)({formComponentType:"ModalForm",layout:"vertical"},d),{},{onInit:function(t,a){var _;d.formRef&&(d.formRef.current=a),d==null||(_=d.onInit)===null||_===void 0||_.call(d,t,a),x.current=a},formRef:x,submitter:le,onFinish:function(){var i=(0,C.Z)((0,h.Z)().mark(function t(a){var _;return(0,h.Z)().wrap(function(u){for(;;)switch(u.prev=u.next){case 0:return u.next=2,ue(a);case 2:return _=u.sent,u.abrupt("return",_);case 4:case"end":return u.stop()}},t)}));return function(t){return i.apply(this,arguments)}}(),contentRender:ie,children:V}))})),oe]})}},46596:function(ne,B,r){r.r(B),r.d(B,{AvatarName:function(){return k}});var h=r(15009),C=r.n(h),P=r(99289),I=r.n(P),H=r(5574),w=r.n(H),y=r(23303),$=r(37476),Z=r(5966),W=r(80854),E=r(2453),l=r(2487),F=r(28036),X=r(67294),o=r(85893),k=function(){var s=(0,W.useModel)("@@initialState"),f=s.initialState,V=f||{},g=V.userInfo;return g==null?void 0:g.username},z=function(){var s=(0,W.useIntl)(),f=(0,W.useModel)("@@initialState"),V=f.initialState,g=f.loading,L=f.refresh,U=f.setInitialState,n=(0,X.useState)(!1),R=w()(n,2),O=R[0],G=R[1],J=(0,X.useState)(!1),T=w()(J,2),S=T[0],d=T[1],j=function(){var A=I()(C()().mark(function b(M){var c;return C()().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,(0,y.C2)(M.username);case 3:if(c=e.sent,c.code===0){e.next=9;break}if(c.code!=-2){e.next=8;break}return E.ZP.error(c.msg),e.abrupt("return",!1);case 8:throw c.msg;case 9:return L(),E.ZP.success(s.formatMessage({id:"pages.vipList.update.success"})),e.abrupt("return",!0);case 14:return e.prev=14,e.t0=e.catch(0),E.ZP.error(s.formatMessage({id:"pages.vipList.update.error"})),e.abrupt("return",!1);case 18:case"end":return e.stop()}},b,null,[[0,14]])}));return function(M){return A.apply(this,arguments)}}(),Q=function(){var A=I()(C()().mark(function b(M){var c;return C()().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(M.password==M.passwordAgain){e.next=3;break}return E.ZP.error(s.formatMessage({id:"enteredPasswordsDiffer"})),e.abrupt("return",!1);case 3:return e.prev=3,e.next=6,(0,y.$5)(M.oldPassword,M.password);case 6:if(c=e.sent,c.code===0){e.next=12;break}if(c.code!=-2){e.next=11;break}return E.ZP.error(c.msg),e.abrupt("return",!1);case 11:throw c.msg;case 12:return E.ZP.success(s.formatMessage({id:"pages.vipList.update.success"})),e.abrupt("return",!0);case 16:return e.prev=16,e.t0=e.catch(3),E.ZP.error(s.formatMessage({id:"pages.vipList.update.error"})),e.abrupt("return",!1);case 20:case"end":return e.stop()}},b,null,[[3,16]])}));return function(M){return A.apply(this,arguments)}}();return(0,o.jsxs)(o.Fragment,{children:[(0,o.jsxs)(l.Z,{itemLayout:"horizontal",children:[(0,o.jsx)(l.Z.Item,{actions:[(0,o.jsx)(F.ZP,{type:"link",onClick:function(){G(!0)},children:s.formatMessage({id:"edit"})})],children:(0,o.jsx)(l.Z.Item.Meta,{title:s.formatMessage({id:"username"}),description:s.formatMessage({id:"pages.Accout.Setting.currentUsername"})+": "+k()})}),(0,o.jsx)(l.Z.Item,{actions:[(0,o.jsx)(F.ZP,{type:"link",onClick:function(){d(!0)},children:s.formatMessage({id:"edit"})})],children:(0,o.jsx)(l.Z.Item.Meta,{title:s.formatMessage({id:"password"}),description:s.formatMessage({id:"pages.Accout.Setting.password.description"})})})]}),(0,o.jsx)($.Y,{title:s.formatMessage({id:"editUsername"}),open:O,onFinish:j,onOpenChange:G,children:(0,o.jsx)(Z.Z,{name:"username",fieldProps:{maxLength:24},rules:[{required:!0,message:"Please enter username!"},{min:5,message:"length min 5"}]})}),(0,o.jsxs)($.Y,{title:s.formatMessage({id:"editPassword"}),open:S,onFinish:Q,onOpenChange:d,children:[(0,o.jsx)(Z.Z.Password,{name:"oldPassword",fieldProps:{maxLength:24},label:s.formatMessage({id:"pages.Accout.Setting.oldPassword"}),rules:[{required:!0,message:"Please enter new password!"},{min:6,message:s.formatMessage({id:"pages.Accout.Setting.password.description"})}]}),(0,o.jsx)(Z.Z.Password,{name:"password",fieldProps:{maxLength:24},label:s.formatMessage({id:"pages.Accout.Setting.newPassword"}),rules:[{required:!0,message:"Please enter new password!"},{min:6,message:s.formatMessage({id:"pages.Accout.Setting.password.description"})}]}),(0,o.jsx)(Z.Z.Password,{name:"passwordAgain",fieldProps:{maxLength:24},label:s.formatMessage({id:"pages.Accout.Setting.reEnter"}),rules:[{required:!0,message:"Please enter new password!"},{min:6,message:s.formatMessage({id:"pages.Accout.Setting.password.description"})}]})]})]})};B.default=z}}]);
