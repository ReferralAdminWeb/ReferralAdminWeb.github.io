"use strict";(self.webpackChunkant_design_pro=self.webpackChunkant_design_pro||[]).push([[463],{5966:function(ee,x,r){var T=r(97685),f=r(1413),E=r(91),W=r(21770),G=r(53025),F=r(55241),$=r(97435),w=r(67294),A=r(45456),P=r(85893),R=["fieldProps","proFieldProps"],i=["fieldProps","proFieldProps"],B="text",X=function(e){var n=e.fieldProps,h=e.proFieldProps,v=(0,E.Z)(e,R);return(0,P.jsx)(A.Z,(0,f.Z)({valueType:B,fieldProps:n,filedConfig:{valueType:B},proFieldProps:h},v))},o=function(e){var n=(0,W.Z)(e.open||!1,{value:e.open,onChange:e.onOpenChange}),h=(0,T.Z)(n,2),v=h[0],Z=h[1];return(0,P.jsx)(G.Z.Item,{shouldUpdate:!0,noStyle:!0,children:function(t){var g,C=t.getFieldValue(e.name||[]);return(0,P.jsx)(F.Z,(0,f.Z)((0,f.Z)({getPopupContainer:function(c){return c&&c.parentNode?c.parentNode:c},onOpenChange:function(c){return Z(c)},content:(0,P.jsxs)("div",{style:{padding:"4px 0"},children:[(g=e.statusRender)===null||g===void 0?void 0:g.call(e,C),e.strengthText?(0,P.jsx)("div",{style:{marginTop:10},children:(0,P.jsx)("span",{children:e.strengthText})}):null]}),overlayStyle:{width:240},placement:"rightTop"},e.popoverProps),{},{open:v,children:e.children}))}})},N=function(e){var n=e.fieldProps,h=e.proFieldProps,v=(0,E.Z)(e,i),Z=(0,w.useState)(!1),b=(0,T.Z)(Z,2),t=b[0],g=b[1];return n!=null&&n.statusRender&&v.name?(0,P.jsx)(o,{name:v.name,statusRender:n==null?void 0:n.statusRender,popoverProps:n==null?void 0:n.popoverProps,strengthText:n==null?void 0:n.strengthText,open:t,onOpenChange:g,children:(0,P.jsx)("div",{children:(0,P.jsx)(A.Z,(0,f.Z)({valueType:"password",fieldProps:(0,f.Z)((0,f.Z)({},(0,$.Z)(n,["statusRender","popoverProps","strengthText"])),{},{onBlur:function(I){var c;n==null||(c=n.onBlur)===null||c===void 0||c.call(n,I),g(!1)},onClick:function(I){var c;n==null||(c=n.onClick)===null||c===void 0||c.call(n,I),g(!0)}}),proFieldProps:h,filedConfig:{valueType:B}},v))})}):(0,P.jsx)(A.Z,(0,f.Z)({valueType:"password",fieldProps:n,proFieldProps:h,filedConfig:{valueType:B}},v))},U=X;U.Password=N,U.displayName="ProFormComponent",x.Z=U},37476:function(ee,x,r){r.d(x,{Y:function(){return U}});var T=r(74165),f=r(15861),E=r(1413),W=r(97685),G=r(91),F=r(73177),$=r(28459),w=r(28248),A=r(55917),P=r(21770),R=r(80334),i=r(67294),B=r(73935),X=r(78733),o=r(85893),N=["children","trigger","onVisibleChange","onOpenChange","modalProps","onFinish","submitTimeout","title","width","visible","open"];function U(p){var e,n,h=p.children,v=p.trigger,Z=p.onVisibleChange,b=p.onOpenChange,t=p.modalProps,g=p.onFinish,C=p.submitTimeout,I=p.title,c=p.width,S=p.visible,Y=p.open,_=(0,G.Z)(p,N);(0,R.ET)(!_.footer||!(t!=null&&t.footer),"ModalForm \u662F\u4E00\u4E2A ProForm \u7684\u7279\u6B8A\u5E03\u5C40\uFF0C\u5982\u679C\u60F3\u81EA\u5B9A\u4E49\u6309\u94AE\uFF0C\u8BF7\u4F7F\u7528 submit.render \u81EA\u5B9A\u4E49\u3002");var V=(0,i.useContext)($.ZP.ConfigContext),Q=(0,i.useState)([]),K=(0,W.Z)(Q,2),y=K[1],j=(0,i.useState)(!1),M=(0,W.Z)(j,2),H=M[0],s=M[1],te=(0,P.Z)(!!S,{value:Y||S,onChange:b||Z}),re=(0,W.Z)(te,2),z=re[0],L=re[1],J=(0,i.useRef)(null),se=(0,i.useCallback)(function(u){J.current===null&&u&&y([]),J.current=u},[]),k=(0,i.useRef)(),ae=(0,i.useCallback)(function(){var u,a,l,m=(u=(a=_.form)!==null&&a!==void 0?a:(l=_.formRef)===null||l===void 0?void 0:l.current)!==null&&u!==void 0?u:k.current;m&&t!==null&&t!==void 0&&t.destroyOnClose&&m.resetFields()},[t==null?void 0:t.destroyOnClose,_.form,_.formRef]);(0,i.useImperativeHandle)(_.formRef,function(){return k.current},[k.current]),(0,i.useEffect)(function(){(Y||S)&&(b==null||b(!0),Z==null||Z(!0))},[S,Y]);var oe=(0,i.useMemo)(function(){return v?i.cloneElement(v,(0,E.Z)((0,E.Z)({key:"trigger"},v.props),{},{onClick:function(){var u=(0,f.Z)((0,T.Z)().mark(function l(m){var O,d;return(0,T.Z)().wrap(function(D){for(;;)switch(D.prev=D.next){case 0:L(!z),(O=v.props)===null||O===void 0||(d=O.onClick)===null||d===void 0||d.call(O,m);case 2:case"end":return D.stop()}},l)}));function a(l){return u.apply(this,arguments)}return a}()})):null},[L,v,z]),le=(0,i.useMemo)(function(){var u,a,l,m,O,d;return _.submitter===!1?!1:(0,A.Z)({searchConfig:{submitText:(u=(a=t==null?void 0:t.okText)!==null&&a!==void 0?a:(l=V.locale)===null||l===void 0||(l=l.Modal)===null||l===void 0?void 0:l.okText)!==null&&u!==void 0?u:"\u786E\u8BA4",resetText:(m=(O=t==null?void 0:t.cancelText)!==null&&O!==void 0?O:(d=V.locale)===null||d===void 0||(d=d.Modal)===null||d===void 0?void 0:d.cancelText)!==null&&m!==void 0?m:"\u53D6\u6D88"},resetButtonProps:{preventDefault:!0,disabled:C?H:void 0,onClick:function(D){var q;L(!1),t==null||(q=t.onCancel)===null||q===void 0||q.call(t,D)}}},_.submitter)},[(e=V.locale)===null||e===void 0||(e=e.Modal)===null||e===void 0?void 0:e.cancelText,(n=V.locale)===null||n===void 0||(n=n.Modal)===null||n===void 0?void 0:n.okText,t,_.submitter,L,H,C]),ie=(0,i.useCallback)(function(u,a){return(0,o.jsxs)(o.Fragment,{children:[u,J.current&&a?(0,o.jsx)(i.Fragment,{children:(0,B.createPortal)(a,J.current)},"submitter"):a]})},[]),ue=(0,i.useCallback)(function(){var u=(0,f.Z)((0,T.Z)().mark(function a(l){var m,O,d;return(0,T.Z)().wrap(function(D){for(;;)switch(D.prev=D.next){case 0:return m=g==null?void 0:g(l),C&&m instanceof Promise&&(s(!0),O=setTimeout(function(){return s(!1)},C),m.finally(function(){clearTimeout(O),s(!1)})),D.next=4,m;case 4:return d=D.sent,d&&L(!1),D.abrupt("return",d);case 7:case"end":return D.stop()}},a)}));return function(a){return u.apply(this,arguments)}}(),[g,L,C]),de=(0,F.X)(z);return(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)(w.Z,(0,E.Z)((0,E.Z)((0,E.Z)({title:I,width:c||800},t),de),{},{onCancel:function(a){var l;C&&H||(L(!1),t==null||(l=t.onCancel)===null||l===void 0||l.call(t,a))},afterClose:function(){var a;ae(),z&&L(!1),t==null||(a=t.afterClose)===null||a===void 0||a.call(t)},footer:_.submitter!==!1?(0,o.jsx)("div",{ref:se,style:{display:"flex",justifyContent:"flex-end"}}):null,children:(0,o.jsx)(X.I,(0,E.Z)((0,E.Z)({formComponentType:"ModalForm",layout:"vertical"},_),{},{onInit:function(a,l){var m;_.formRef&&(_.formRef.current=l),_==null||(m=_.onInit)===null||m===void 0||m.call(_,a,l),k.current=l},formRef:k,submitter:le,onFinish:function(){var u=(0,f.Z)((0,T.Z)().mark(function a(l){var m;return(0,T.Z)().wrap(function(d){for(;;)switch(d.prev=d.next){case 0:return d.next=2,ue(l);case 2:return m=d.sent,d.abrupt("return",m);case 4:case"end":return d.stop()}},a)}));return function(a){return u.apply(this,arguments)}}(),contentRender:ie,children:h}))})),oe]})}},46596:function(ee,x,r){r.r(x),r.d(x,{AvatarName:function(){return N}});var T=r(15009),f=r.n(T),E=r(99289),W=r.n(E),G=r(5574),F=r.n(G),$=r(23303),w=r(37476),A=r(5966),P=r(80854),R=r(2453),i=r(2487),B=r(28036),X=r(67294),o=r(85893),N=function(){var e=(0,P.useModel)("@@initialState"),n=e.initialState,h=n||{},v=h.userInfo;return v==null?void 0:v.username},U=function(){var e=(0,P.useIntl)(),n=(0,P.useModel)("@@initialState"),h=n.initialState,v=n.loading,Z=n.refresh,b=n.setInitialState,t=(0,X.useState)(!1),g=F()(t,2),C=g[0],I=g[1],c=(0,X.useState)(!1),S=F()(c,2),Y=S[0],_=S[1],V=function(){var K=W()(f()().mark(function y(j){var M;return f()().wrap(function(s){for(;;)switch(s.prev=s.next){case 0:return s.prev=0,s.next=3,(0,$.C2)(j.username);case 3:if(M=s.sent,M.code===0){s.next=9;break}if(M.code!=-2){s.next=8;break}return R.ZP.error(M.msg),s.abrupt("return",!1);case 8:throw M.msg;case 9:return Z(),R.ZP.success(e.formatMessage({id:"pages.vipList.update.success"})),s.abrupt("return",!0);case 14:return s.prev=14,s.t0=s.catch(0),R.ZP.error(e.formatMessage({id:"pages.vipList.update.error"})),s.abrupt("return",!1);case 18:case"end":return s.stop()}},y,null,[[0,14]])}));return function(j){return K.apply(this,arguments)}}(),Q=function(){var K=W()(f()().mark(function y(j){var M;return f()().wrap(function(s){for(;;)switch(s.prev=s.next){case 0:if(j.password==j.passwordAgain){s.next=3;break}return R.ZP.error(e.formatMessage({id:"enteredPasswordsDiffer"})),s.abrupt("return",!1);case 3:return s.prev=3,s.next=6,(0,$.$5)(j.oldPassword,j.password);case 6:if(M=s.sent,M.code===0){s.next=12;break}if(M.code!=-2){s.next=11;break}return R.ZP.error(M.msg),s.abrupt("return",!1);case 11:throw M.msg;case 12:return R.ZP.success(e.formatMessage({id:"pages.vipList.update.success"})),s.abrupt("return",!0);case 16:return s.prev=16,s.t0=s.catch(3),R.ZP.error(e.formatMessage({id:"pages.vipList.update.error"})),s.abrupt("return",!1);case 20:case"end":return s.stop()}},y,null,[[3,16]])}));return function(j){return K.apply(this,arguments)}}();return(0,o.jsxs)(o.Fragment,{children:[(0,o.jsxs)(i.Z,{itemLayout:"horizontal",children:[(0,o.jsx)(i.Z.Item,{actions:[(0,o.jsx)(B.ZP,{type:"link",onClick:function(){I(!0)},children:e.formatMessage({id:"edit"})})],children:(0,o.jsx)(i.Z.Item.Meta,{title:e.formatMessage({id:"username"}),description:e.formatMessage({id:"pages.Accout.Setting.currentUsername"})+": "+N()})}),(0,o.jsx)(i.Z.Item,{actions:[(0,o.jsx)(B.ZP,{type:"link",onClick:function(){_(!0)},children:e.formatMessage({id:"edit"})})],children:(0,o.jsx)(i.Z.Item.Meta,{title:e.formatMessage({id:"password"}),description:e.formatMessage({id:"pages.Accout.Setting.password.description"})})})]}),(0,o.jsx)(w.Y,{title:e.formatMessage({id:"editUsername"}),open:C,onFinish:V,onOpenChange:I,children:(0,o.jsx)(A.Z,{name:"username",fieldProps:{maxLength:24},rules:[{required:!0,message:"Please enter username!"},{min:5,message:"length min 5"}]})}),(0,o.jsxs)(w.Y,{title:e.formatMessage({id:"editPassword"}),open:Y,onFinish:Q,onOpenChange:_,children:[(0,o.jsx)(A.Z.Password,{name:"oldPassword",fieldProps:{maxLength:24},label:e.formatMessage({id:"pages.Accout.Setting.oldPassword"}),rules:[{required:!0,message:"Please enter new password!"},{min:6,message:e.formatMessage({id:"pages.Accout.Setting.password.description"})}]}),(0,o.jsx)(A.Z.Password,{name:"password",fieldProps:{maxLength:24},label:e.formatMessage({id:"pages.Accout.Setting.newPassword"}),rules:[{required:!0,message:"Please enter new password!"},{min:6,message:e.formatMessage({id:"pages.Accout.Setting.password.description"})}]}),(0,o.jsx)(A.Z.Password,{name:"passwordAgain",fieldProps:{maxLength:24},label:e.formatMessage({id:"pages.Accout.Setting.reEnter"}),rules:[{required:!0,message:"Please enter new password!"},{min:6,message:e.formatMessage({id:"pages.Accout.Setting.password.description"})}]})]})]})};x.default=U}}]);
